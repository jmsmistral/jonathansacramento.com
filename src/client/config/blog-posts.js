
  const blogPosts = [{"id":1,"route":"improve-your-postgresql-workflow-with-vim-and-dbext","title":"Improve your PostgreSQL workflow with vim and dbext","content":"<p>If you&#39;ve worked with PostgreSQL in the past using the <a href=\"http://www.postgresql.org/docs/current/static/app-psql.html\">psql</a> client you might have noticed that, although powerful, it&#39;s not a tool geared for writing (or reading) complex multi-line queries, or following a &#39;write-execute-refine&#39; workflow; that is, where you write some code, execute it, refine the code based on the results, etc. So, let&#39;s say I write some SQL code in vim, and I want to run some of it to see if it works. I would have to copy the block of code I want to run to a new buffer, save the file, switch to psql, type &quot;\\i filepath&quot;, and wait for the results (... and now you have a new file to maintain temporarily). This is definitely something we can reduce to one or two keystrokes from within vim (God forbid we have to move our fingers away from the &#39;hjkl&#39; position).</p>\n<blockquote>\n<h2 id=\"wouldnt-it-be-nice-to-be-able-to-write-execute-and-view-the-results-from-within-vim\">Wouldn&#39;t it be nice to be able to write, execute, and view the results from within vim?</h2>\n</blockquote>\n<p><a href=\"https://github.com/vim-scripts/dbext.vim\">dbext</a> is a vim plugin that aims to do exactly that (credit to the author Peter Bagyinszki)! Don&#39;t be put-off by the poorly presented <a href=\"https://github.com/vim-scripts/dbext.vim\">Github</a> or <a href=\"http://www.vim.org/scripts/script.php?script_id=356\">Vim scripts</a> page - the plugin comes with a helpful tutorial (described below) that covers what you need to know. Here, I will show you what I had to do to get started using dbext.</p>\n<h2 id=\"what-you-need\">What you need</h2>\n<p>You need to have vim 7+, and the psql client installed locally. You&#39;ll also need access to a PostgreSQL server.</p>\n<h2 id=\"download-and-configure-dbext\">Download and configure dbext</h2>\n<p>I use the <a href=\"https://github.com/tpope/vim-pathogen\">Pathogen</a> vim plugin to easily install other plugins and run-time files. If you do too, then just navigate to the <code>~/.vim/bundle/</code> folder in your home directory and clone the dbext Github repository.</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> <span class=\"hljs-built_in\">cd</span> ~/.vim/bundle/</span>\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> git <span class=\"hljs-built_in\">clone</span> https://github.com/vim-scripts/dbext.vim</span>\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> ls</span>\ndbext.vim/</code></pre>\n<p>That&#39;s it - installed!</p>\n<p>dbext works by relating every vim buffer to a database connection profile that we define in our .vimrc. A connection profile describes a set of parameters needed to connect to a database, such as username, host, port, database name etc. We can define various profiles, and also define a default profile to use whenever a new buffer is opened in vim. Open your .vimrc file and enter the following two lines, making sure you substitute your values for host, port, dbname, and user (for PostgreSQL, leave the type as &#39;PGSQL&#39;). In the example below, we are connecting to a database called &#39;jms&#39;, as user &#39;jms&#39;, on a server running on the same machine &#39;localhost&#39; via port 5433.</p>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-string\">\" Each profile has the form:\n\"</span> g:dbext<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">default</span><span class=\"hljs-number\">_p</span>rofile<span class=\"hljs-number\">_</span><span class=\"hljs-string\">'profilename'</span> = <span class=\"hljs-string\">'var=value:var=value:...'</span>\n<span class=\"hljs-keyword\">let</span> g:dbext<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">default</span><span class=\"hljs-number\">_p</span>rofile<span class=\"hljs-number\">_p</span>sql = <span class=\"hljs-string\">'type=PGSQL:host=localhost:port=5433:dbname=jms:user=jms'</span>\n<span class=\"hljs-keyword\">let</span> g:dbext<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">default</span><span class=\"hljs-number\">_p</span>rofile = <span class=\"hljs-string\">'psql'</span></code></pre>\n<p>Notice that we&#39;re not entering our password - this is because the psql client either asks us for a password when we connect (or everytime we execute a query with dbext), or looks for a .pgpass file in our home directory. I recommend having a .pgpass file. This file typically has a single line of the form: <code>hostname:port:database:username:password</code></p>\n<h2 id=\"running-queries\">Running queries</h2>\n<p>Now that we have dbext installed, let&#39;s see what we can do with it! I do recommend taking some time to read over the tutorial that comes with dbext by typing the following in vim:</p>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-selector-pseudo\">:h</span> <span class=\"hljs-selector-tag\">dbext-tutorial</span></code></pre>\n<p>So, fire-up vim and select some data from a table in your database.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">select</span> * <span class=\"hljs-keyword\">from</span> staging.customer;</code></pre>\n<p>We can run this either in normal mode or visual mode. In normal mode, simply move the cursor somewhere within the query (within, and including, the &#39;s&#39; or &#39;;&#39;) and type the following, replacing \\ with your leader character.</p>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-string\">\\se</span></code></pre>\n<p>This will bring up the results buffer - a read-only split window displaying the results for the executed statement(s); To focus on this press Ctrl + w twice in quick succession. You can now navigate the results buffer. To close the results buffer, first switch to it, and then press q. If the results window is too small, you can even-out the split window by pressing Ctrl + w once, followed by =. Alternatively, you can type :res +5 or :res -5 to make the split window bigger or smaller by 5 rows.</p>\n<p><img src=\"/img/improve-postgresql-workflow-vim-dbext-1.png\" alt=\"\"></p>\n<p>If we had multiple queries and only wanted to run one, or a couple of them, we could enter visual mode to select them (Shift + v followed by j or k to select rows down or up) and again type \\se, as before.</p>\n<p><img src=\"/img/improve-postgresql-workflow-vim-dbext-2.png\" alt=\"\"></p>\n<p>Isn&#39;t that exciting?!! That&#39;s just a taster - I&#39;ve added a small reference of dbext commands at the end of the post. Before that, there&#39;s a cool feature you&#39;ll love... auto-completion.</p>\n<h2 id=\"auto-completion\">Auto-completion</h2>\n<p>When working with a large number of tables/views, it can be hard to remember all their names. dbext can help-out with a pop-up menu of potential matches. This functionality does require the following to be done:</p>\n<ul>\n<li>You must be working from a saved file ending in .sql</li>\n<li>Populate the vim dictionary using either of the following commands DBCompleteTables, DBCompleteViews, or DBCompleteProcedures</li>\n</ul>\n<p>To avoid having to type a DBComplete* command whenever I start a new buffer, I added this to my .vimrc (this runs the given command once all plugins have been loaded):</p>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-attribute\">autocmd</span> VimEnter * DBCompleteTables</code></pre>\n<p>Once that&#39;s done and dusted, start typing a SELECT statement. After the FROM keyword, press Ctrl + x followed by Ctrl + o, this will bring up a menu showing all matching tables. If we had started typing the name of the table, and then brought-up the menu, it would filter for those tables matching what we&#39;ve typed so far. Scroll up and down the menu with Ctrl + n and Ctrl + p.</p>\n<p><img src=\"/img/improve-postgresql-workflow-vim-dbext-3.png\" alt=\"\"></p>\n<h2 id=\"quick-reference\">Quick Reference</h2>\n<h3 id=\"code-execution\">Code Execution</h3>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-comment\">\" Execute code in normal or visual mode. (s)ql (e)xecute</span>\n\\<span class=\"hljs-keyword\">se</span>\n\n<span class=\"hljs-comment\">\" Execute just the current line. (s)ql (e)xecute (l)ine</span>\n\\sel</code></pre>\n<h3 id=\"select-from-tables\">Select from Tables</h3>\n<pre><code class=\"hljs language-vim\">\" <span class=\"hljs-keyword\">Select</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-keyword\">table</span> (s)ql (t)able\n<span class=\"hljs-string\">\" Place cursor over table name, or visual mode select schema &amp; table name\n\\st\n\n\"</span> <span class=\"hljs-keyword\">Select</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-keyword\">table</span>, <span class=\"hljs-keyword\">prompt</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">number</span> <span class=\"hljs-keyword\">of</span> <span class=\"hljs-keyword\">rows</span> <span class=\"hljs-keyword\">to</span> <span class=\"hljs-keyword\">return</span>  (s)ql (T)able\n<span class=\"hljs-string\">\" Place cursor over table name, or visual mode select schema &amp; table name\n\\sT\n\n\"</span> <span class=\"hljs-keyword\">Select</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-keyword\">table</span>, <span class=\"hljs-keyword\">prompt</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">WHERE</span> clause  (s)ql (t)able (w)here\n<span class=\"hljs-string\">\" Place cursor over table name, or visual mode select schema &amp; table name\n\\stw</span></code></pre>\n<h3 id=\"describe-objects\">Describe Objects</h3>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-string\">\" Describe table (s)ql (d)escribe (t)able\n\"</span> Place cursor over table name, <span class=\"hljs-keyword\">or</span> visual mode select schema &amp; table name\n\\sdt\n\n<span class=\"hljs-string\">\" Describe procedure (s)ql (d)escribe (p)rocedure\n\"</span> Place cursor over <span class=\"hljs-function\"><span class=\"hljs-keyword\">procedure</span> <span class=\"hljs-title\">name</span>, <span class=\"hljs-title\">or</span> <span class=\"hljs-title\">visual</span> <span class=\"hljs-title\">mode</span> <span class=\"hljs-title\">select</span> <span class=\"hljs-title\">schema</span> &amp; <span class=\"hljs-title\">procedure</span> <span class=\"hljs-title\">name</span>\n\\<span class=\"hljs-title\">sdp</span>\n\n\" <span class=\"hljs-title\">Describe</span> <span class=\"hljs-title\">procedure</span> <span class=\"hljs-params\">(s)</span><span class=\"hljs-title\">ql</span> <span class=\"hljs-params\">(d)</span><span class=\"hljs-title\">escribe</span> <span class=\"hljs-params\">(v)</span><span class=\"hljs-title\">iew</span>\n\" <span class=\"hljs-title\">Place</span> <span class=\"hljs-title\">cursor</span> <span class=\"hljs-title\">over</span> <span class=\"hljs-title\">view</span> <span class=\"hljs-title\">name</span>, <span class=\"hljs-title\">or</span> <span class=\"hljs-title\">visual</span> <span class=\"hljs-title\">mode</span> <span class=\"hljs-title\">select</span> <span class=\"hljs-title\">schema</span> &amp; <span class=\"hljs-title\">view</span> <span class=\"hljs-title\">name</span>\n\\<span class=\"hljs-title\">sdv</span></span></code></pre>\n<h3 id=\"listing-objects\">Listing Objects</h3>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-string\">\" List tables in database (s)ql (l)ist (t)able\n\"</span> Prompts <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">string</span> <span class=\"hljs-keyword\">to</span> match tables <span class=\"hljs-keyword\">by</span> <span class=\"hljs-built_in\">name</span>\n\\slt\n\n<span class=\"hljs-string\">\" Same but for procedures\n\\slp\n\n\"</span> Same <span class=\"hljs-keyword\">but</span> <span class=\"hljs-keyword\">for</span> views\n\\slv\n\n<span class=\"hljs-string\">\" Get list of table columns in paste buffer (s)ql (l)ist (c)olumns\n\"</span> Place cursor <span class=\"hljs-keyword\">over</span> table <span class=\"hljs-built_in\">name</span>. Recognises schemas <span class=\"hljs-keyword\">without</span> visual mode selection\n<span class=\"hljs-string\">\" Prompts for alias prefix to be added\n\\slc</span></code></pre>\n<h3 id=\"results-buffer-run-inside-results-buffer\">Results Buffer (run inside results buffer)</h3>\n<pre><code class=\"hljs language-vim\">\" Re-<span class=\"hljs-keyword\">run</span> <span class=\"hljs-keyword\">query</span> that generated current results buffer\n<span class=\"hljs-built_in\">R</span>\n\n\" <span class=\"hljs-keyword\">Close</span> results buffer\n<span class=\"hljs-built_in\">q</span></code></pre>\n<h3 id=\"command-history\">Command History</h3>\n<pre><code class=\"hljs language-vim\"><span class=\"hljs-string\">\" List recently executed statements \n\"</span> Press RETURN key <span class=\"hljs-keyword\">on</span> selected statement <span class=\"hljs-keyword\">to</span> re-execute\n\\sh</code></pre>\n","date":"January 22, 2016"},{"id":2,"route":"clean-sql","title":"Clean SQL","content":"","date":"November 19, 2016"},{"id":3,"route":"predicting-churn-without-machine-learning","title":"Predicting Churn without Machine Learning","content":"","date":"April 16, 2017"}];
  
  module.exports = {
      blogPosts,
  };
  